<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">

  <title>Hello, world!</title>
</head>

<body>
  <div class="container-fluid">
    <div class="row vh-100">
      <div class="d-flex justify-content-center col-md-6 bg-light">
        <div class="align-self-center">
          <form class="row g-3 mx-5">
            <div class="col-7">
              <select class="form-select px-3 py-2 shadow" id="listports" aria-label="Menu"
                style="border-radius: 15px;">
              </select>
            </div>
            <div class="col-2 text-center ">
              <button type="submit" class="btn btn-dark mt-2 shadow" id="open">Open</button>
            </div>
            <div class="col-2 text-center ">
              <button type="submit" class="btn btn-dark mt-2 shadow" id="close">Close</button>
            </div>
            <div class="col-1 text-center ">
              <button type="submit" class="btn mt-2 shadow" id="statport"
                style="background-color:crimson; border-radius: 100px;">&#8203;</button>
            </div>
            <div class="col-12" style="margin-top: 100px;">
              <h2 class="text-center">Web Serial</h2>
            </div>
            <div class="form-group col-md-3">
              <input type="text" class="form-control px-3 py-2 shadow" id="datainput1" placeholder="Data1"
                style="border-radius: 15px;">
            </div>
            <div class="form-group col-md-3">
              <input type="text" class="form-control px-3 py-2 shadow" id="datainput2" placeholder="Data2"
                style="border-radius: 15px;">
            </div>
            <div class="form-group col-md-3">
              <input type="text" class="form-control px-3 py-2 shadow" id="datainput3" placeholder="Data3"
                style="border-radius: 15px;">
            </div>
            <div class="col-3">
              <select class="form-select px-3 py-2 shadow" id="dataoption" aria-label="Menu"
                style="border-radius: 15px;">
                <option selected>Soal1</option>
                <option>Soal2</option>
                <option>Soal3</option>
                <option>Soal4</option>
                <option>Soal5</option>
              </select>
            </div>
            <!-- <div class="col-12 text-center">
              <div class="d-inline-block">Data Formatted : </div>
              <div class="d-inline-block" id="formatted">asd</div>
            </div> -->
            <div class="col-12 text-center">
              <button type="submit" class="btn btn-dark mt-2 shadow" id="send">Send Data</button>
            </div>
            <div class="col-6 text-center d-inline-block d-none">
              <button type="submit" class="btn btn-dark mt-2 shadow" id="send1">Send Data1</button>
            </div>
            <div class="col-6 text-center d-inline-block d-none">
              <button type="submit" class="btn btn-dark mt-2 shadow" id="send2">Send Data2</button>
            </div>
          </form>
        </div>
      </div>
      <div class="d-flex justify-content-center col-md-6 bg-dark">
        <div class="align-self-center h-75 w-75">
          <h2 class="mt-3 text-light">Serial Monitor : </h2>
          <div class="card h-75" style="border-radius: 20px;">
            <div class="card-body">
              <textarea name="" id="serialmonitor" class="w-100 h-100 p-2" style="border-radius: 10px;"></textarea>
            </div>
          </div>
          <div class="col-12 text-center">
            <button type="submit" class="btn btn-light mt-2 shadow" id="clearmonit">Clear Monitor</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Option 1: Bootstrap Bundle with Popper -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
    crossorigin="anonymous"></script> -->
  <script src="/socket.io/socket.io.js"></script>
  <script>
    var socket = io.connect(); document.getElementsByTagName("form")[0].onsubmit = function (e) { e.preventDefault() }; var semo = document.getElementById("serialmonitor"), data1 = document.getElementById("datainput1"), data2 = document.getElementById("datainput2"), data3 = document.getElementById("datainput3"), dataoption = document.getElementById("dataoption"), send = document.getElementById("send"), send1 = document.getElementById("send1"), send2 = document.getElementById("send2"), clear = document.getElementById("clearmonit"), listports = document.getElementById("listports"), open = document.getElementById("open"), close = document.getElementById("close"), statport = document.getElementById("statport"), type = 1, choport = ""; function checkOnchange(e) { isNaN(e.value) ? e.value = "" : (1 == type && (e == data1 && (Number(data1.value) < 51 && (data1.value = "51"), Number(data1.value) > 100 && (data1.value = "100")), e == data2 && (Number(data2.value) < 101 && (data2.value = "101"), Number(data2.value) > 150 && (data2.value = "150")), e == data3 && (Number(data3.value) < 151 && (data3.value = "151"), Number(data3.value) > 200 && (data3.value = "200")), e.value = "" + Number(e.value)), 2 == type && (Number(e.value) > 254 && (e.value = "254"), Number(e.value) < 0 && (e.value = "0"), e.value = "" + Number(e.value)), 3 == type && (Number(e.value) > 999 && (e.value = "999"), Number(e.value) < 0 && (e.value = "000"), 2 == e.value.length && (e.value = "0" + e.value), 1 == e.value.length && (e.value = "00" + e.value)), 4 == type && (Number(e.value) > 100 && (e.value = "100"), Number(e.value) < 0 && (e.value = "0"), e.value = "" + Number(e.value))) } socket.on("listports", (e => { listports.innerHTML = "", e.forEach((e => { let a = document.createElement("option"); a.innerText = e, listports.appendChild(a) })), "" != choport && (listports.value = choport) })), open.onclick = function (e) { socket.emit("openport", listports.value) }, close.onclick = function (e) { socket.emit("closeport") }, socket.on("portopened", (e => { statport.style.backgroundColor = "lime", listports.value = e })), socket.on("portclosed", (() => { statport.style.backgroundColor = "crimson" })), socket.on("datain", (e => { semo.value += e, semo.scrollTop = semo.scrollHeight })), send.onclick = function (e) { let a; 1 == type && (a = new Uint8Array(new ArrayBuffer(4)), a[0] = Number(data1.value), a[1] = Number(data2.value), a[2] = Number(data3.value), a[3] = "\r".charCodeAt(0)), 2 == type && (a = new Uint8Array(new ArrayBuffer(4)), a[0] = 255, a[1] = Number(data1.value), a[2] = Number(data2.value), a[3] = Number(data3.value)), 3 == type && (a = "#" + data1.value + data2.value + data3.value), 4 == type && (a = data1.value + "," + data2.value + "," + data3.value + "\r"), socket.emit("datasoal1-4", a) }, send1.onclick = function (e) { console.log("asd"), socket.emit("datasoal5", "Data1?") }, send2.onclick = function (e) { console.log("dsa"), socket.emit("datasoal5", "Data2?") }, clearmonit.onclick = function (e) { semo.value = "" }, data1.onkeyup = function (e) { data1.value.length > 3 && (data1.value = data1.value.slice(data1.value.length - 3, data1.value.length)) }, data1.onchange = function (e) { checkOnchange(data1) }, data2.onkeyup = function (e) { data2.value.length > 3 && (data2.value = data2.value.slice(data2.value.length - 3, data2.value.length)) }, data2.onchange = function (e) { checkOnchange(data2) }, data3.onkeyup = function (e) { data3.value.length > 3 && (data3.value = data3.value.slice(data3.value.length - 3, data3.value.length)) }, data3.onchange = function (e) { checkOnchange(data3) }, dataoption.onchange = function (e) { if ("Soal5" != dataoption.value) { for (let e = 0; e < 3; e++)document.getElementsByTagName("input")[e].disabled = !1; send.parentElement.classList.remove("d-none"), send1.parentElement.classList.add("d-none"), send2.parentElement.classList.add("d-none") } switch (dataoption.value) { case "Soal1": type = 1; break; case "Soal2": type = 2; break; case "Soal3": type = 3; break; case "Soal4": type = 4; break; case "Soal5": type = 5; for (let e = 0; e < 3; e++)document.getElementsByTagName("input")[e].disabled = !0; send.parentElement.classList.add("d-none"), send1.parentElement.classList.remove("d-none"), send2.parentElement.classList.remove("d-none") }data1.value = "", data2.value = "", data3.value = "" }, listports.onchange = function (e) { choport = listports.value };
  </script>
</body>

</html>